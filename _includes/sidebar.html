{% if page.author_profile or layout.author_profile or page.sidebar %}
  <div class="sidebar sticky">
    {% if page.author_profile or layout.author_profile %}
      {% include author-profile.html %}
    {% endif %}

    {% if page.sidebar %}
      {% for s in page.sidebar %}
        {% if s.image %}
          <img src="{{ s.image | relative_url }}"
               alt="{% if s.image_alt %}{{ s.image_alt }}{% endif %}">
        {% endif %}
        {% if s.title %}<h3>{{ s.title }}</h3>{% endif %}
        {% if s.text %}{{ s.text | markdownify }}{% endif %}
        {% if s.nav %}{% include nav_list nav=s.nav %}{% endif %}
      {% endfor %}
      
      <!-- Combine nav keys -->
      {% assign combined_nav = "" %}
      {% if page.sidebar.nav %}
        {% assign combined_nav = combined_nav | append: page.sidebar.nav | append: "," %}
      {% endif %}
      {% if page.sidebar.nav2 %}
        {% assign combined_nav = combined_nav | append: page.sidebar.nav2 | append: "," %}
      {% endif %}
      {% if page.sidebar.nav3 %}
        {% assign combined_nav = combined_nav | append: page.sidebar.nav3 | append: "," %}
      {% endif %}
      {% if page.sidebar.nav4 %}
        {% assign combined_nav = combined_nav | append: page.sidebar.nav4 | append: "," %}
      {% endif %}
      {% if page.sidebar.nav5 %}
        {% assign combined_nav = combined_nav | append: page.sidebar.nav5 | append: "," %}
      {% endif %}

      <!-- Remove trailing comma and split into array -->
      {% assign combined_nav = combined_nav | strip | strip_trailing: "," | split: "," %}

      <!-- Include combined nav -->
      {% include nav_list nav=combined_nav %}
    {% endif %}
  </div>
{% endif %}
