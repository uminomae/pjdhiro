<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>Julia-set Inverse Mapping</title>
  <meta name="google-site-verification" content="google1dd9a6e9f696a4f9" />

  <!-- Bootstrap CSS -->
  <link
    href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css"
    rel="stylesheet"
    crossorigin="anonymous"
  />

  <!-- 自作の CSS -->
  <link rel="stylesheet" href="css/d2-style.css" />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css"
  />
</head>
<body class="bg-dark text-light">

  <!-- ────────────── ナビバー ────────────── -->
  <!-- 置換対象：画面上部にあった <nav>…</nav> 部分を以下に差し替え -->
  <nav class="navbar navbar-dark bg-secondary fixed-top">
    <div class="container-fluid">
      <!-- 左端：ブランド／ページタイトル -->
      <a class="navbar-brand" href="#">
        Julia-set Inverse Mapping
      </a>

      <!-- 中央：Run/一時停止/再開 ボタン群 -->
      <div class="d-flex mx-auto">
        <button id="start-btn" class="btn btn-primary mx-1">Run</button>
        <button id="pause-btn" class="btn btn-warning mx-1">一時停止</button>
        <button id="resume-btn" class="btn btn-success mx-1">再開</button>
      </div>

      <!-- 右端：設定 Offcanvas 用トグル ＋ 更新履歴 Offcanvas 用トグル -->
      <div class="d-flex">
        <!-- 設定用 Offcanvas を開くボタン -->
        <button
          class="btn btn-outline-light mx-1"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasConfig"
          aria-controls="offcanvasConfig"
        >
          <span class="navbar-toggler-icon"></span>
          <small class="ms-1">設定</small>
        </button>

        <!-- 更新履歴用 Offcanvas を開くボタン -->
        <button
          class="btn btn-outline-light mx-1"
          type="button"
          data-bs-toggle="offcanvas"
          data-bs-target="#offcanvasHistory"
          aria-controls="offcanvasHistory"
        >
          <i class="bi bi-journal-text"></i>
          <small class="ms-1">更新履歴</small>
        </button>
      </div>
    </div>
  </nav>
  <!-- ここまで差し替え -->

  <!-- （下のコンテンツはナビバーのすぐ下に “十分な余白” を入れておきます） -->
  <div style="height: 56px;"></div>
    
  <!-- ────────────── メインコンテナ ────────────── -->
  <div class="container-fluid px-3 py-4">
    <!-- キャンバスをセンターに配置 -->
    <div class="row justify-content-center">
      <div class="col-lg-8 col-md-10 col-12 mb-4">
        <div id="canvas-container" class="position-relative border rounded overflow-hidden">
          <img
            id="bg-image"
            src="img/onmyo.png"
            alt="陰陽マーク"
            class="position-absolute top-50 start-50 translate-middle opacity-10"
            style="width: 40%;"
          />
          <canvas
            id="inverse-canvas"
            class="w-100"
            style="aspect-ratio: 4/3; background: transparent;"
            width="800"
            height="600"
          ></canvas>
        </div>

        <!-- 計算式表示：キャンバス真下、横長 -->
        <div id="formula" class="mt-3 p-3 rounded" style="white-space: pre-wrap; background: transparent;">
          ここに計算式・処理内容が表示されます。
        </div>
      </div>
    </div>
  </div>
  <!-- /.container-fluid -->

  <!-- ────────────── 設定フォーム用 Offcanvas ────────────── -->
  <div
    class="offcanvas offcanvas-start bg-dark text-light"
    tabindex="-1"
    id="offcanvasConfig"
    aria-labelledby="offcanvasConfigLabel"
  >
    <div class="offcanvas-header border-bottom border-secondary">
      <h5 class="offcanvas-title" id="offcanvasConfigLabel">設定</h5>
      <button
        type="button"
        class="btn-close btn-close-white"
        data-bs-dismiss="offcanvas"
        aria-label="閉じる"
      ></button>
    </div>
    <div class="offcanvas-body">
      <div id="config">
        <div class="mb-3">
          <label for="cRe" class="form-label">c の実部 (cRe)</label>
          <input
            type="number"
            id="cRe"
            class="form-control form-control-lg"
            step="0.001"
            placeholder="例: -0.4"
            data-default-value="-0.4"
          >
          <div class="form-text text-light">
            ジュリア集合を決める複素定数 c の実部です。<br>
            推奨：−1.5〜1.5
          </div>
        </div>
        <div class="mb-3">
          <label for="cIm" class="form-label">c の虚部 (cIm)</label>
          <input
            type="number"
            id="cIm"
            class="form-control form-control-lg"
            step="0.001"
            placeholder="例: 0.6"
            data-default-value="0.6"
          >
          <div class="form-text text-light">
            ジュリア集合を決める複素定数 c の虚部です。推奨：0.0〜1.0
          </div>
        </div>
        <div class="mb-3">
          <label for="samples" class="form-label">samples (サンプリング数)</label>
          <input
            type="number"
            id="samples"
            class="form-control form-control-lg"
            step="1"
            placeholder="例: 45"
            data-default-value="45"
          >
          <div class="form-text text-light">
            最初の円を描画する点の数。45〜360 程度が目安。
          </div>
        </div>
        <div class="mb-3">
          <label for="maxIter" class="form-label">maxIter (世代数)</label>
          <input
            type="number"
            id="maxIter"
            class="form-control form-control-lg"
            step="1"
            placeholder="例: 12"
            data-default-value="12"
          >
          <div class="form-text text-light">
            逆写像を繰り返す回数。10〜20 程度が目安。
          </div>
        </div>
        <div class="mb-3">
          <label for="pauseMs" class="form-label">pauseMs (一時停止時間)</label>
          <input
            type="number"
            id="pauseMs"
            class="form-control form-control-lg"
            step="100"
            placeholder="例: 500"
            data-default-value="500"
          >
          <div class="form-text text-light">
            各ステップの停止時間 (ms)。500〜3000ms 程度がおすすめ。
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- ────────────── 更新履歴用 Offcanvas ────────────── -->
  <div
    class="offcanvas offcanvas-end bg-dark text-light"
    tabindex="-1"
    id="offcanvasHistory"
    aria-labelledby="offcanvasHistoryLabel"
  >
    <div class="offcanvas-header border-bottom border-secondary">
      <h5 class="offcanvas-title" id="offcanvasHistoryLabel">更新履歴</h5>
      <button
        type="button"
        class="btn-close btn-close-white"
        data-bs-dismiss="offcanvas"
        aria-label="閉じる"
      ></button>
    </div>
    <div class="offcanvas-body">
      <ul class="list-unstyled small" style="line-height: 1.6;">
        <li class="mb-3">
          <time datetime="2025-06-01" class="fw-bold">2025-06-01</time><br>
          — 逆写像アニメーションの極座標補間を追加、ステップごとのカラー表示を改善<br>
          — 背景画像とキャンバスの重ね合わせ機能を実装
        </li>
        <li class="mb-3">
          <time datetime="2025-05-31" class="fw-bold">2025-05-31</time><br>
          — 初期バージョン公開（単位円→逆写像アニメーション）
        </li>
        <!-- 必要に応じて追加 -->
      </ul>
    </div>
  </div>

  <!-- Bootstrap JS -->
  <script
    src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"
    crossorigin="anonymous"
  ></script>

  <!-- スクリプト本体 -->
  <script type="module" src="js/2d/d2-main.js"></script>
</body>
</html>
